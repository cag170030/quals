<!DOCTYPE html>
<html>
<head>
  <title>Piston in rigid tube</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        macros: {
          Order: "{\\mathcal O}",
          vec: ['\\boldsymbol{#1}', 1],
          div: "{\\boldsymbol{\\nabla}\\cdot}",
          grad: "{\\boldsymbol\\nabla}",
          curl: "{\\boldsymbol\\nabla\\times}",
          Laplacian: "{\\nabla^2}",
          dAlambertian: "{\\Box^2}",
          Order: "{\\mathcal O}",
          T: "{^\\mathsf{T}}"
        }
      }
    };
  </script>
  <style>
    body {
      margin: 20px;
      background: linear-gradient(to bottom, #0907799a, #c3470974);
      font-family: Arial;
      height: 100%;
      background-repeat: no-repeat;
      background-attachment: fixed;
      line-height: 1.5;
    }

    .textbox {
      background-color: rgba(255, 253, 230, 0.866);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }

    h1 {
      text-align: center;
    }

    .image-gallery {
      display: flex;
      justify-content: space-between;
    }

    .image-gallery img {
      border-radius: 10px;
      max-width: 30%; 
      height: auto;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
<div class="textbox">
<h1>Piston in rigid tube</h1>
<p>This problem was worked out by Dr. Hamilton in Acoustics II, while covering waveguides (Ch. 12 of <i>Fundamentals of Physical Acoustics</i> by Blackstock). Note the following differences between my work below and Dr. Hamilton's: 
<ul>
<li>In class, \(a\) was the radius of the larger cylinder with rigid boundary conditions, while \(b\) was the radius of the piston. In my work, the meaning of these letters is flipped, i.e., \(a\) is the radius of the piston, while \(b\) is the radius of the larger cylinder. </li>
<li>Dr. Hamilton worked it out in the \(j\omega t\) time convention; my work is in the \(-i\omega t\) convention.</li>
<li>I am skeptical of the validity of the Fourier-Bessel series for \(r > a\), so I also plot the solution.</li>
</ul>
For a treatment of this problem more along the lines of Dr. Hamilton's presentation, see problem 3 of <a href="https://cag170030.github.io/quals/physical.html#12" target="_blank" rel="noopener noreferrer">chapter 12 of my physical acoustics quals review webpage.</a>
</p>
</div>

<div class="textbox"> <h2>Problem statement</h2>
<p>Solve the wave equation for the pressure field radiated by a uniform circular velocity source of radius \(a\) positioned with its center on the axis of a rigid cylindrical tube  of radius \(b\). </p>
<img src="fig_piston-in-tube.svg"/>
<p>The source conditions at \(z=0\) are
\begin{alignat*}{2}
u^{(z)} &= u_0 e^{-i\omega t},\quad &&r\in [0,a]\\
u^{(z)} &= 0,\quad &&r\in (a,b]
\end{alignat*}
and \(\partial p/\partial r = 0\) at \(r=b\) for all \(z\). Note that 
\begin{equation}
\int_0^1 J_m(\alpha'_{mn} x )J_m(\alpha'_{mn'} x) \,x\, dx = \frac{1}{2}[1-(m/\alpha'_{mn})^2] J^2_m(\alpha'_{mn'}) \delta_{nn'} \label{orthogonalityint}\tag{i}
\end{equation}
is the relevant orthogonality integral. </p>
</div>
<div class="textbox"><h2>Solution</h2>
<p>First of all, there should be no dependence on \(\theta\), because the piston is positioned on-axis. Thus, the azimuthal index \(m\) is set to \(0\).</p> 
<p>Since \(\partial p/\partial r = 0\) at \(r=b\), 
\begin{align*}
J'_0(k_r b) = 0 \, \implies \, k_r = \alpha'_{0n}/b\,.
\end{align*}
Thus, \(k_z = \beta_n = \sqrt{(\omega/c_0)^2- (\alpha'_{0n}/b)^2}\), and the general solution to the wave equation is 
\begin{equation} \label{general solution}\tag{ii}
p(r,z,t) = \sum_{n=1}^\infty  A_n J_0(\alpha'_{0n}r/b) e^{i(\beta_n z- \omega t)}\,.
\end{equation}
</p>
<p> Meanwhile, to satisfy the source condition at \(z = 0\), the momentum equation \(u^{(z)} = (i\omega \rho_0)^{-1}{\partial p}/{\partial z}\) is invoked and set equal to the source condition:
\begin{align}
\frac{1}{\rho_0 c_0 k}\sum_{n=1}^\infty  A_n \beta_n J_0(\alpha'_{0n} r/b) e^{-i{\omega t}}= \begin{cases}
u_0 e^{-i\omega t},\quad &r\in [0,a]\\
0,\quad & r\in (a,b]
\end{cases}\,.\tag{iii}\label{sldfkjlkjkljlk}
\end{align}
</p>
<p>The orthogonality relation given by Eq. \eqref{orthogonalityint} is now used to find the expansion coefficients \(A_n\). Letting \(x = r/b\) and thus \(dx = dr/b\), the orthogonality relation becomes
\[\int_0^b J_m(\alpha'_{mn} r/b)J_m(\alpha'_{mn'} r/b) r\, dr = \frac{b^2}{2}[1-(m/\alpha'_{mn})^2] J^2_m(\alpha'_{mn'}) \delta_{nn'}\,,\]
which for \(m=0\) reads
\begin{equation}\label{orthogonalityint'}\tag{iv}
\int_0^b J_0(\alpha'_{0n} r/b)J_0(\alpha'_{0n'} r/b) r\, dr = \frac{b^2}{2} J^2_0(\alpha'_{0n'}) \delta_{nn'} \,.
\end{equation}
Multiplying both sides of Eq. \eqref{sldfkjlkjkljlk} by \(J_0(\alpha'_{0n'} r/b) r dr\) gives
\begin{align*}
\frac{1}{\rho_0 c_0 k}\sum_{n=1}^\infty \beta_n A_n J_0(\alpha'_{0n} r/b)J_0(\alpha'_{0n'} r/b) r dr  = \begin{cases}
u_0 J_0(\alpha'_{0n'} r/b) r dr,\quad &r\in [0,a]\\
0,\quad & r\in (a,b]
\end{cases}\,,
\end{align*}
where the \(e^{-i\omega t}\) time dependence has been suppressed. Integrating from \(0\) to \(b\) gives
\begin{align*}
\frac{1}{\rho_0 c_0 k}\sum_{n=1}^\infty \beta_n A_n \int_{0}^{b} J_0(\alpha'_{0n} r/b)J_0(\alpha'_{0n'} r/b) r dr  &= 
u_0 \int_{0}^{a} J_0(\alpha'_{0n'} r/b) r dr\end{align*}
Eq. \eqref{orthogonalityint'} is used to integrate the left-hand side, and the recursion relation given by equation (11-A-24c) in Blackstock's book is used to integrate the right-hand side by setting \(v = r/b\) and \(dv = dr/b\):
\begin{align*}
\frac{b^2}{\rho_0 c_0 k}\sum_{n'=1}^\infty \beta_n A_n \frac{1}{2} J_0^2(\alpha'_{0n'}) \delta_{nn'}  &= u_0 ({b}/{\alpha'_{0n'}})^2  v J_1(v)\bigg\rvert_{v=0}^{v=\alpha'_{0n'}a/b}\\
\frac{b^2}{2\rho_0 c_0} \frac{\beta_n}{k} A_n J_0^2(\alpha'_{0n})  &=u_0 \, ab \, \frac{1}{\alpha'_{0n}} J_1(\alpha'_{0n}a/b)\,
\end{align*}
Solving for \(A_n\) results in
\begin{equation}\label{An}\tag{v}
A_n  = \rho_0 c_0 u_0 \, \frac{a}{b}\,  \frac{2k}{\beta_n\alpha'_{0n}}\,   \frac{J_1(\alpha'_{0n}a/b)}{J_0^2(\alpha'_{0n}) }\,.
\end{equation}
Insertion of Eq. \eqref{An} into Eq. \eqref{general solution} results in the solution to the wave equation,
\begin{equation}\label{solution}\tag{vi}
p(r,z,t) = \rho_0 c_0 u_0\, 2k \, \frac{a}{b} \sum_{n = 1}^\infty \,  \frac{1}{\beta_n\alpha'_{0n}}\,  \frac{J_1(\alpha'_{0n}a/b)}{J_0^2(\alpha'_{0n}) }\, J_0(\alpha'_{0n}r/b)\, e^{i(\beta_n z- \omega t)}\,,
\end{equation}
where \(\beta_n = \sqrt{(\omega/c_0)^2- (\alpha'_{0n}/b)^2}\).
</p>
</div>

<div class="textbox"><h2>Sanity checks</h2>
<p>To check the validity of Eq. \eqref{solution}, several limiting cases are studied. </p>
<ol>
<li><p><i>Does Eq. \eqref{solution} satisfy the radial boundary condition, i.e., does \(\partial p/\partial r\rvert_{r=b}=0\)?</i></p>
<p>This is easy to check by differentiating Eq. \eqref{solution} with respect to \(r\), setting \(r=b\), and noting that \(J_0'(\alpha'_{0n}) = 0\). Thus all the terms in the infinite series vanish, and thus the radial boundary condition has been satisfied. </p>
</li>
<li><p><i>Does Eq. \eqref{solution} recover the velocity source condition?</i></p> 
<p>To check this, insert the expansion coefficients given by Eq. \eqref{An} into the velocity source condition given by Eq. \eqref{sldfkjlkjkljlk}, and compare the left- and right-hand-sides. After canceling common terms, one obtains
\begin{align}
2 \frac{a}{b}\sum_{n=1}^\infty \frac{1}{\alpha'_{0n}}\,   \frac{J_1(\alpha'_{0n}a/b)}{J_0^2(\alpha'_{0n}) } J_0(\alpha'_{0n} r/b) \stackrel{?}{=} \begin{cases}
1,\quad &r\in [0,a]\\
0,\quad & r\in (a,b]
\end{cases}\,.
\end{align}
To check this result, the above equation is nondimensionalized by defining \(\gamma \equiv a/b\) and \(R \equiv r/a\):
\begin{align}\label{verifyit}\tag{vii}
2 \gamma \sum_{n=1}^\infty \frac{1}{\alpha'_{0n}}\,   \frac{J_1(\alpha'_{0n}\gamma)}{J_0^2(\alpha'_{0n}) } J_0(\alpha'_{0n} \gamma R) \stackrel{?}{=} \begin{cases}
1,\quad & R \in [0,1]\\
0,\quad & R\in (1,1/\gamma]
\end{cases}\,.
\end{align}
 The roots of the derivative of the \(0^\mathrm{th}\) order Bessel function are given by <a href="https://www.mathworks.com/matlabcentral/fileexchange/28001-bessel-derivative-zeros" target="_blank" rel="noopener noreferrer">Bessel Derivative Zeros</a> (and I verified the first few roots of \(J_0\) by comparing with those listed on page 393 of <i>Fundamentals of Physical Acoustics</i>).  
</p>
<p>However, I am struggling to show this result. See <a href="sanity_check_2.m" target="_blank" rel="noopener noreferrer">here</a> for my code that attempts (and fails) to show that the LHS and RHS of Eq. \eqref{verifyit} are equal. For example, for \(\gamma = a/b = 1/2\), one obtains </p>
<img src="first_40_terms.png"/>

</li>


</ol>
</div>

<!--
<div class="image-gallery">
<img src="bat2.jpg" alt="Bat 2">
<img src="bat3.jpg" alt="Bat 3">
<img src="bat1.jpg" alt="Bat 1">
</div>


<div class="textbox">
<p style="font-size:11px">
Chirag Gokani <br>
<a href="mailto:chiragokani@gmail.com" target="_blank" rel="noopener noreferrer">chiragokani@gmail.com</a> | <a href="https://cag170030.github.io/chirag/" target="_blank" rel="noopener noreferrer">homepage</a> <br>
<a href="https://www.texasacoustics.org/" target="_blank" rel="noopener noreferrer">PhD student, Acoustics</a> | <a href="https://www.utexas.edu/" target="_blank" rel="noopener noreferrer">University of Texas at Austin</a> <br>
</p>
</div>
-->
</body>
</html>

